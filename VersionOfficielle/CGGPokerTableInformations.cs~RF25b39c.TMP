using System;
using System.Collections;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;
using VersionOfficielle.Helpers;
using WindowScrape.Types;

namespace VersionOfficielle
{
    enum ScreenPosition
    {
        North = 0,
        Est,
        South,
        West,

        ScreenPositionCount
    }



    class CGGPokerTableInformations : VersionOfficielle.Interfaces.ITableInformations
    {
        CGGPokerHandReader theHandReader;
        Dictionary<ScreenPosition, CPlayer> FFTable = new Dictionary<ScreenPosition, CPlayer>();
        Dictionary<PokerPosition, CPokerPlayer> FFTablePoker = new Dictionary<PokerPosition, CPokerPlayer>();
        ScreenPosition FFcardPosBB;
        ScreenPosition FFcardPosSB;
        ScreenPosition FFcardPosDE;
        ScreenPosition FFcardPosCO;

        CPokerPlayer FFDealer;
        CPokerPlayer FFSB;
        CPokerPlayer FFBB;
        CPokerPlayer FFCO;

        public HwndObject FFWindowHandle;
        static private Bitmap FFcurrentHand;

        int FFPlayingPlayerCount;
        int FFPlayerCount;

        public void ActualizePositions()
        {
            CGGPokerBoardReader theReader = new CGGPokerBoardReader(FFWindowHandle);

            FFDealer = new CPokerPlayer();
            FFSB = new CPokerPlayer();
            FFBB = new CPokerPlayer();
            FFCO = new CPokerPlayer();

            for (int i = 0; i < (int)ScreenPosition.ScreenPositionCount; i++)
            {
                FFTable[(ScreenPosition)i].Reinitialize();
            }
            Console.WriteLine("------ UPDATING FFPOS ------");
            FFcardPosBB = getBBCardPos();
            FFcardPosSB = getSBCardPos();
            FFcardPosDE = getDealerCardPos();
            if (getPreviousCardinalPos(FFcardPosDE) != FFcardPosBB && FFPlayerCount == 4)
            {
                FFcardPosCO = getCOCardPos();
                FFCO.FFPos = FFcardPosCO;
            }

            Console.WriteLine("------ UPDATING NbPlayingPlayers ------");
            ActualizePlayingPlayersCount();

            Console.WriteLine("------ UPDATING CPokerPlayers ------");
            FFBB.FFPos = FFcardPosBB;
            FFSB.FFPos = FFcardPosSB;
            FFDealer.FFPos = FFcardPosDE;

            Console.WriteLine("------ UPDATING FFTABLE ------");
            FFTable[FFcardPosBB].FFPos = PokerPosition.BB;
            FFTable[FFcardPosDE].FFPos = PokerPosition.dealer;
            FFTable[FFcardPosSB].FFPos = PokerPosition.SB;
            if (FFPlayingPlayerCount == 4)
                FFTable[FFcardPosCO].FFPos = PokerPosition.CO;

            Console.WriteLine("------ POSITIONS OF PLAYERS ------");
            Console.WriteLine("NORTH: " + getPokerPosByCardPos(ScreenPosition.North));
            Console.WriteLine("SOUTH: " + getPokerPosByCardPos(ScreenPosition.South));
            Console.WriteLine("EAST: " + getPokerPosByCardPos(ScreenPosition.Est));
            Console.WriteLine("WEST: " + getPokerPosByCardPos(ScreenPosition.West));
        }

        public void ActualizePlayerCount()
        {
            FFPlayerCount = getNbDetectedPlayers();
        }


        public void ActualizeHand()
        {
            Console.WriteLine("Actualizing hand");
            theHandReader.ActualizeHand();
            Console.WriteLine("Actualizing done");
        }

        public void ActualizeStackAndBets()
        {

            FFTable[FFcardPosBB].FFBet = FFBB.FFBet = getBetFromCardPos(FFcardPosBB);
            FFTable[FFcardPosDE].FFBet = FFDealer.FFBet = getBetFromCardPos(FFcardPosDE);
            FFTable[FFcardPosSB].FFBet = FFSB.FFBet = getBetFromCardPos(FFcardPosSB);
            if (FFPlayingPlayerCount == 4)
            {
                FFTable[FFcardPosCO].FFBet = FFCO.FFBet = getBetFromCardPos(FFcardPosCO);
            }

            FFTable[FFcardPosBB].FFStack = FFBB.FFStack = getStackFromCardPos(FFcardPosBB);
            FFTable[FFcardPosDE].FFStack = FFDealer.FFStack = getStackFromCardPos(FFcardPosDE);
            FFTable[FFcardPosSB].FFStack = FFSB.FFStack = getStackFromCardPos(FFcardPosSB);
            if (FFPlayingPlayerCount == 4)
            {
                FFTable[FFcardPosCO].FFStack = FFCO.FFStack = getStackFromCardPos(FFcardPosCO);
            }

            FFTablePoker[PokerPosition.BB] = FFBB;
            FFTablePoker[PokerPosition.SB] = FFSB;
            FFTablePoker[PokerPosition.dealer] = FFDealer;
            FFTablePoker[PokerPosition.CO] = FFCO;

            Console.WriteLine("------ STACKS ------");
            Console.WriteLine("NORTH: " + FFTable[ScreenPosition.North].FFStack);
            Console.WriteLine("SOUTH: " + FFTable[ScreenPosition.South].FFStack);
            Console.WriteLine("EAST: " + FFTable[ScreenPosition.Est].FFStack);
            Console.WriteLine("WEST: " + FFTable[ScreenPosition.West].FFStack);
            Console.WriteLine("------ BETS ------");
            Console.WriteLine("NORTH: " + FFTable[ScreenPosition.North].FFBet);
            Console.WriteLine("SOUTH: " + FFTable[ScreenPosition.South].FFBet);
            Console.WriteLine("EAST: " + FFTable[ScreenPosition.Est].FFBet);
            Console.WriteLine("WEST: " + FFTable[ScreenPosition.West].FFBet);
        }

        public CGGPokerTableInformations(HwndObject _windowHandle)
        {
            FFWindowHandle = _windowHandle;
            FFTable.Add(ScreenPosition.West, new CPlayer(PokerPosition.PokerPositionCount, 0, 0, PlayerStates.openedSeat));
            FFTable.Add(ScreenPosition.North, new CPlayer(PokerPosition.PokerPositionCount, 0, 0, PlayerStates.openedSeat));
            FFTable.Add(ScreenPosition.Est, new CPlayer(PokerPosition.PokerPositionCount, 0, 0, PlayerStates.openedSeat));
            FFTable.Add(ScreenPosition.South, new CPlayer(PokerPosition.PokerPositionCount, 0, 0, PlayerStates.openedSeat));

            FFTablePoker.Add(PokerPosition.SB, new CPokerPlayer(ScreenPosition.ScreenPositionCount, 0, 0, PlayerStates.openedSeat));
            FFTablePoker.Add(PokerPosition.BB, new CPokerPlayer(ScreenPosition.ScreenPositionCount, 0, 0, PlayerStates.openedSeat));
            FFTablePoker.Add(PokerPosition.dealer, new CPokerPlayer(ScreenPosition.ScreenPositionCount, 0, 0, PlayerStates.openedSeat));
            FFTablePoker.Add(PokerPosition.CO, new CPokerPlayer(ScreenPosition.ScreenPositionCount, 0, 0, PlayerStates.openedSeat));

            theHandReader = new CGGPokerHandReader(FFWindowHandle);
        }

        public double getOurStack()
        {
            return FFTable[ScreenPosition.South].FFBet + FFTable[ScreenPosition.South].FFStack;
        }

        private bool isBetPresentAtThisCardPos(ScreenPosition _pos)
        {
            CGGPokerBoardReader theReader = new CGGPokerBoardReader(FFWindowHandle);
            switch (_pos)
            {
                case ScreenPosition.North:
                    return theReader.NorthPlayerBet != 0;
                case ScreenPosition.West:
                    return theReader.WestPlayerBet != 0;
                case ScreenPosition.South:
                    return theReader.SouthPlayerBet != 0;
                case ScreenPosition.Est:
                    return theReader.EstPlayerBet != 0;
                default:
                    throw new Exception("Card pos is invalid");
            }
        }

        private double getBetFromCardPos(ScreenPosition _pos)
        {
            CGGPokerBoardReader theReader = new CGGPokerBoardReader(FFWindowHandle);
            switch (_pos)
            {
                case ScreenPosition.North:
                    return theReader.NorthPlayerBet;
                case ScreenPosition.West:
                    return theReader.WestPlayerBet;
                case ScreenPosition.South:
                    return theReader.SouthPlayerBet;
                case ScreenPosition.Est:
                    return theReader.EstPlayerBet;
                default:
                    throw new Exception("Card pos is invalid");
            }
        }

        private ScreenPosition getPreviousCardinalPos(ScreenPosition _pos)
        {
            int thePos = (int)_pos;
            --thePos;
            if (thePos == -1)
                thePos = 3;
            return (ScreenPosition)thePos;
        }

        private ScreenPosition getNextCardinalPos(ScreenPosition _pos)
        {
            int thePos = (int)_pos;
            ++thePos;
            if (thePos == (int)ScreenPosition.ScreenPositionCount)
                thePos = 0;
            return (ScreenPosition)thePos;
        }

        private ScreenPosition getSBCardPos()
        {
            ScreenPosition posBB = FFcardPosBB;
            ScreenPosition posSB = getPreviousCardinalPos(posBB);

            if (!isBetPresentAtThisCardPos(posSB))
            {
                posSB = getPreviousCardinalPos(posSB);
                if (!isBetPresentAtThisCardPos(posSB))
                {
                    posSB = getPreviousCardinalPos(posSB);
                    if (!isBetPresentAtThisCardPos(posSB))
                    {
                        throw new Exception("SB not found");
                    }
                }
            }
            return posSB;
        }

        private ScreenPosition getBBCardPos()
        {
            CGGPokerBoardReader theReader = new CGGPokerBoardReader(FFWindowHandle);
            ScreenPosition posBB;

            if (theReader.EstPlayerBet == CGGPokerConsantes.GG_LIMIT.getLimit())
            {
                posBB = ScreenPosition.Est;
            }
            else if (theReader.NorthPlayerBet == CGGPokerConsantes.GG_LIMIT.getLimit())
            {
                posBB = ScreenPosition.North;
            }
            else if (theReader.WestPlayerBet == CGGPokerConsantes.GG_LIMIT.getLimit())
            {
                posBB = ScreenPosition.West;
            }
            else if (theReader.SouthPlayerBet == CGGPokerConsantes.GG_LIMIT.getLimit())
            {
                posBB = ScreenPosition.South;
            }
            else
            {
                throw new Exception("BB not found");
            }
            ScreenPosition insurance = getPreviousCardinalPos(posBB);
            if (getBetFromCardPos(insurance) == CGGPokerConsantes.GG_LIMIT.getLimit())
                posBB = insurance;
            return posBB;
        }

        private ScreenPosition getDealerCardPos()
        {
            CGGPokerBoardReader boardReader = new CGGPokerBoardReader(FFWindowHandle);
            CPosition dealerScreenPos = boardReader.GetDealerPositionOnScreen();
            ScreenPosition dealerCardPos = getPlayerScreenPosition(dealerScreenPos);
            return dealerCardPos;
        }

        private ScreenPosition getCOCardPos()
        {
            //if (FFPlayerCount != 4)
                //throw new Exception("CO does not exist when NB players is < than 4");
            return getPreviousCardinalPos(FFcardPosDE);
        }

        private ScreenPosition getPlayerScreenPosition(CPosition _pos)
        {
            if (_pos.Y < CGGPokerConsantes.GG_SCREEN_NORTH_LOWER_BOUND)
            {
                return ScreenPosition.North;
            }
            else if (_pos.X > CGGPokerConsantes.GG_SCREEN_EST_LEFT_BOUND)
            {
                return ScreenPosition.Est;
            }
            else if (_pos.Y > CGGPokerConsantes.GG_SCREEN_SOUTH_UPPER_BOUND)
            {
                return ScreenPosition.South;
            }
            else if (_pos.X < CGGPokerConsantes.GG_SCREEN_WEST_RIGHT_BOUND)
            {
                return ScreenPosition.West;
            }
            else
            {
                throw new Exception("The position specified is not a player position");
            }
        }

        private ScreenPosition getCardPosByPokerPos(PokerPosition _pos)
        {
            return FFTablePoker[_pos].FFPos;
        }

        private PokerPosition getPokerPosByCardPos(ScreenPosition _pos)
        {
            return FFTable[_pos].FFPos;
        }

        private double getStackFromCardPos(ScreenPosition _pos)
        {
            CGGPokerBoardReader theReader = new CGGPokerBoardReader(FFWindowHandle);
            switch (_pos)
            {
                case ScreenPosition.North:
                    return theReader.NorthPlayerStack;
                case ScreenPosition.West:
                    return theReader.WestPlayerStack;
                case ScreenPosition.South:
                    return theReader.SouthPlayerStack;
                case ScreenPosition.Est:
                    return theReader.EstPlayerStack;
                default:
                    throw new Exception("Card pos is invalid");
            }
        }

        private double getStackFromPokerPos(PokerPosition _pos)
        {
            return FFTablePoker[_pos].FFStack;
        }

        private double getBiggestStackNextPlayers(PokerPosition _pos)
        {
            double biggestStackNextPlayers = FFBB.FFStack + FFBB.FFBet;
            ScreenPosition nextPos = getNextCardinalPos(getCardPosByPokerPos(_pos));
            ScreenPosition cardPosBB = FFcardPosBB;

            if (nextPos != cardPosBB)
            {
                biggestStackNextPlayers = Math.Max(biggestStackNextPlayers, FFTable[nextPos].FFStack + FFTable[nextPos].FFBet);
                nextPos = getNextCardinalPos(nextPos);
                if (nextPos != cardPosBB)
                {
                    biggestStackNextPlayers = Math.Max(biggestStackNextPlayers, FFTable[nextPos].FFStack + FFTable[nextPos].FFBet);
                    nextPos = getNextCardinalPos(nextPos);
                    if (nextPos != cardPosBB)
                    {
                        throw new Exception("No BB detected, PROBLEM!!!!!");
                    }
                }
            }
            return biggestStackNextPlayers;
        }

        public int getNbDetectedPlayers()
        {
            //TODO: À vérifier cette méthode
            // not working properly
            CGGPokerBoardReader boardReader = new CGGPokerBoardReader(FFWindowHandle);

            List<CPosition> theList = boardReader.getPlayersPosition();

            bool westPresent = false;
            bool northPresent = false;
            bool estPresent = false;

            foreach (CPosition pos in theList)
            {
                if (!westPresent && pos.X < CGGPokerConsantes.GG_SCREEN_WEST_RIGHT_BOUND)
                    westPresent = true;
                if (!northPresent && pos.Y < CGGPokerConsantes.GG_SCREEN_NORTH_LOWER_BOUND)
                    northPresent = true;
                if (!estPresent && pos.X > CGGPokerConsantes.GG_SCREEN_EST_LEFT_BOUND)
                    estPresent = true;

            }

            int playerCount = 1;
            if (westPresent) playerCount++;
            if (northPresent) playerCount++;
            if (estPresent) playerCount++;

            return playerCount;
        }

        public void ActualizePlayingPlayersCount()
        {

            if (FFcardPosDE == FFcardPosSB)
            {
                FFPlayingPlayerCount = 2;
            }
            else if (FFPlayerCount == 3 || FFcardPosSB != getPreviousCardinalPos(FFcardPosBB) || FFcardPosDE != getPreviousCardinalPos(FFcardPosSB))
            {
                FFPlayingPlayerCount = 3;
            }
            else if (FFPlayerCount == 4)
            {
                FFPlayingPlayerCount = 4;
            }           
        }

        public string PlayerListToText()
        {
            ActualizePlayingPlayersCount();
            string theString = "";
            theString += "Nb Player: " + FFPlayingPlayerCount.ToString() + "\n";

            theString += "Player States: " + "\n";
            theString += "      | ";
            theString += getPlayerPokerPosString(ScreenPosition.North);
            theString += " |\n ";
            theString += getPlayerPokerPosString(ScreenPosition.West);
            theString += " |      | ";
            theString += getPlayerPokerPosString(ScreenPosition.Est);
            theString += "\n      | ";
            theString += getPlayerPokerPosString(ScreenPosition.South);
            theString += " |\n\n";

            theString += "Player stacks: " + "\n";
            theString += "      | ";
            theString += GetPlayerStackToString(ScreenPosition.North);
            theString += " |\n ";
            theString += GetPlayerStackToString(ScreenPosition.West);
            theString += " |      | ";
            theString += GetPlayerStackToString(ScreenPosition.Est);
            theString += "\n      | ";
            theString += GetPlayerStackToString(ScreenPosition.South);
            theString += " |\n\n";

            return theString;
        }

        public string getPlayerPokerPosString(ScreenPosition _pos)
        {
            PokerPosition pokerPos = getPokerPosByCardPos(_pos);

            switch (pokerPos)
            {
                case PokerPosition.BB:
                    return "BB";
                case PokerPosition.SB:
                    return "SB";
                case PokerPosition.dealer:
                    return "De";
                case PokerPosition.CO:
                    return "CO";
                default:
                    return "";             
            }
        }

        private string GetPlayerStackToString(ScreenPosition _pos)
        {
            return getStackFromCardPos(_pos).ToString();
        }

        private PokerPosition myPokerPosition()
        {
            return FFTable[ScreenPosition.South].FFPos;
        }

        private bool isPlayerAllIn(PokerPosition _pos)
        {
            return FFTablePoker[_pos].isAllin();
        }

        private bool isPlayerAllIn(ScreenPosition _pos)
        {
            return FFTable[_pos].IsAllIn();
        }

        public void ActualizeHandNumber()
        {
            Console.WriteLine("Updating Hand Number");
            CGGPokerBoardReader theReader = new CGGPokerBoardReader(FFWindowHandle);
            FFcurrentHand = theReader.getHandNumberBmp();
            Console.WriteLine("Updating Done");
        }

        public bool isNewHand()
        {
            CGGPokerBoardReader theReader = new CGGPokerBoardReader(FFWindowHandle);
            if (FFcurrentHand == null)
                return true;
            return theReader.isNewHand(FFcurrentHand);
        }

        public Dictionary<CAllInPokerGame.Position, byte> getBBEquivalentOfCallers()
        {
            if (!someoneOpenShoved() || getNumberOfCallers() == 0)
                throw new Exception("there is no callers");
            PokerPosition openShoverPokerPos = (PokerPosition)getPositionOfOpenShover();
            ScreenPosition screenPosOfOpenShover = getCardPosByPokerPos(openShoverPokerPos);
            Dictionary<CAllInPokerGame.Position, byte> theDictionnary = new Dictionary<CAllInPokerGame.Position, byte>();

            if (getNumberOfCallers() == 2)
            {
                double stackCaller1 = FFTablePoker[PokerPosition.dealer].FFBet;
                double stackCaller2 = FFTablePoker[PokerPosition.SB].FFBet;
                double stackOpener = FFTablePoker[PokerPosition.CO].FFBet;
                double myStack = FFTablePoker[PokerPosition.BB].FFBet + FFTablePoker[PokerPosition.BB].FFStack;

                double equivalentBBCall1 = Math.Max(stackOpener, myStack);
                equivalentBBCall1 = Math.Max(equivalentBBCall1, stackCaller2);
                byte finalEquivalentBBCall1 = CPokerGame.ConvertToBB(CGGPokerConsantes.GG_LIMIT, equivalentBBCall1);

                double equivalentBBCall2 = Math.Max(stackOpener, myStack);
                equivalentBBCall2 = Math.Max(equivalentBBCall2, stackCaller1);
                byte finalEquivalentBBCall2 = CPokerGame.ConvertToBB(CGGPokerConsantes.GG_LIMIT, equivalentBBCall2);

                theDictionnary.Add(FromMyPokerPosToCAllInPokerPos(getPokerPosByCardPos(FFcardPosDE)), finalEquivalentBBCall1);
                theDictionnary.Add(FromMyPokerPosToCAllInPokerPos(getPokerPosByCardPos(FFcardPosSB)), finalEquivalentBBCall2);
            }
            else
            {
                ScreenPosition callerCardPos;
                if (isPlayerAllIn(FFcardPosSB))
                {
                    callerCardPos = FFcardPosSB;
                }
                else
                {
                    callerCardPos = FFcardPosDE;
                }
                double callerStack = FFTable[callerCardPos].FFBet;
                double stackOpener = FFTablePoker[openShoverPokerPos].FFBet;
                double biggestNextStack = getBiggestStackNextPlayers(getPokerPosByCardPos(callerCardPos));
                biggestNextStack = Math.Max(biggestNextStack, stackOpener);

                double equivalentBBStack = Math.Min(biggestNextStack, callerStack);
                byte bEquivalentBBStack = CPokerGame.ConvertToBB(CGGPokerConsantes.GG_LIMIT, equivalentBBStack);

                theDictionnary.Add(FromMyPokerPosToCAllInPokerPos(getPokerPosByCardPos(callerCardPos)), bEquivalentBBStack);

            }

            return theDictionnary;
        }

        public byte getBBEquivalentShove()
        {
            if (!someoneOpenShoved())
                throw new Exception("there is no open shovers");

            PokerPosition thePokerPosOfOpener = FromCAllPokerPosToMyPokerPos(getPositionOfOpenShover());

            double stack = getBiggestStackNextPlayers(thePokerPosOfOpener);

            stack = Math.Min(stack, getStackFromPokerPos(thePokerPosOfOpener));

            return CPokerGame.ConvertToBB(CGGPokerConsantes.GG_LIMIT, stack);
        }

        public CAllInPokerGame.Position getMyPosition()
        {
            switch (myPokerPosition())
            {
                case PokerPosition.CO:
                    return CAllInPokerGame.Position.CO;
                case PokerPosition.dealer:
                    return CAllInPokerGame.Position.DEALER;
                case PokerPosition.SB:
                    return CAllInPokerGame.Position.SB;
                case PokerPosition.BB:
                    return CAllInPokerGame.Position.BB;
                default:
                    throw new Exception("This situation should not happen!");
            }
        }

        public CAllInPokerGame.Position getPositionOfOpenShover()
        {
            if (!someoneOpenShoved())
                throw new Exception("No one did open Shove");
            if (FFPlayingPlayerCount == 4)
            {
                if (isPlayerAllIn(FFcardPosCO))
                    return CAllInPokerGame.Position.CO;
            }
            if (FFPlayingPlayerCount >= 3)
            {
                if (isPlayerAllIn(FFcardPosDE))
                    return CAllInPokerGame.Position.DEALER;
            }
            if (FFPlayingPlayerCount >= 2)
            {

                if (isPlayerAllIn(FFcardPosSB))
                    return CAllInPokerGame.Position.SB;
            }
            throw new Exception("there is a problem with Players Detection");
        }

        public byte getNumberOfCallers()
        {
            CGGPokerBoardReader theReader = new CGGPokerBoardReader(FFWindowHandle);

            int count = 0;

            if (FFTable[ScreenPosition.Est].IsAllIn())
                ++count;
            if (FFTable[ScreenPosition.North].IsAllIn())
                ++count;
            if (FFTable[ScreenPosition.West].IsAllIn())
                ++count;

            return (byte)(count-1);
        }

        public byte getOurBBEquivalentShove()
        {
            //TODO: change converToBB025.
            double ourStack = FFTable[ScreenPosition.South].FFBet + FFTable[ScreenPosition.South].FFStack;
            double theStackToUse = 0;
            ScreenPosition ourPos = ScreenPosition.South;

            theStackToUse = getBiggestStackNextPlayers(getPokerPosByCardPos(ourPos));
            theStackToUse = Math.Min(ourStack, theStackToUse);

            return CPokerGame.ConvertToBB(CGGPokerConsantes.GG_LIMIT, theStackToUse);
        }

        public bool isOurHandInThisRange(string _range)
        {
            string[] theTable = CPokerRangeConverter.ConvertRange(_range);
            string hand1 = theHandReader.FFActualHand[0].ToString() + theHandReader.FFActualHand[1];
            string hand2 = theHandReader.FFActualHand[1].ToString() + theHandReader.FFActualHand[0];

            foreach(string theComboInTheTableFromTheRangeConverter in theTable)
            {
                if (theComboInTheTableFromTheRangeConverter == hand1 || theComboInTheTableFromTheRangeConverter == hand2)
                    return true;
            }
            return false;
        }

        public bool someoneCalledAnOpenShoved()
        {
            CGGPokerBoardReader theReader = new CGGPokerBoardReader(FFWindowHandle);

            int count = 0;

            if (FFTable[ScreenPosition.Est].IsAllIn())
                ++count;
            if (FFTable[ScreenPosition.North].IsAllIn())
                ++count;
            if (FFTable[ScreenPosition.West].IsAllIn())
                ++count;

            return count > 1;
        }

        public bool someoneOpenShoved()
        {
            return FFTable[ScreenPosition.West].IsAllIn() || FFTable[ScreenPosition.North].IsAllIn() || FFTable[ScreenPosition.Est].IsAllIn();
        }

        public PokerPosition FromCAllPokerPosToMyPokerPos(CAllInPokerGame.Position _pos)
        {
            switch (_pos) {
                case CAllInPokerGame.Position.BB:
                    return PokerPosition.BB;
                case CAllInPokerGame.Position.SB:
                    return PokerPosition.SB;
                case CAllInPokerGame.Position.DEALER:
                    return PokerPosition.dealer;
                case CAllInPokerGame.Position.CO:
                    return PokerPosition.CO;
                default:
                    throw new Exception("Bad position");
            }
        }

        public CAllInPokerGame.Position FromMyPokerPosToCAllInPokerPos(PokerPosition _pos)
        {
            switch (_pos)
            {
                case PokerPosition.BB:
                    return CAllInPokerGame.Position.BB;
                case PokerPosition.SB:
                    return CAllInPokerGame.Position.SB;
                case PokerPosition.dealer:
                    return CAllInPokerGame.Position.DEALER;
                case PokerPosition.CO:
                    return CAllInPokerGame.Position.CO;
                default:
                    throw new Exception("Bad position");
            }
        }
    }
}
